
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.2.5">
    
    
      
        <title>Infraestructura - Tutorial Frontend - Backend</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.2d9f7617.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/style.css">
    
    <script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#infraestructura-spring-cloud" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../../.." title="Tutorial Frontend - Backend" class="md-header__button md-logo" aria-label="Tutorial Frontend - Backend" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Tutorial Frontend - Backend
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Infraestructura
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="B칰squeda" placeholder="B칰squeda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Limpiar" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando b칰squeda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navegaci칩n" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Tutorial Frontend - Backend" class="md-nav__button md-logo" aria-label="Tutorial Frontend - Backend" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Tutorial Frontend - Backend
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Bienvenido!
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../thanks/" class="md-nav__link">
        Agradecimientos!
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../usecases/" class="md-nav__link">
        Contexto de la aplicaci칩n
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4">
          Entorno de desarrollo
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Entorno de desarrollo" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Entorno de desarrollo
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../install/angular/" class="md-nav__link">
        游댯 Angular
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../install/springboot/" class="md-nav__link">
        游릭 Spring Boot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../install/nodejs/" class="md-nav__link">
        游릭 Nodejs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5">
          Estructura y buenas pr치cticas
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Estructura y buenas pr치cticas" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Estructura y buenas pr치cticas
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../cleancode/angular/" class="md-nav__link">
        游댯 Angular
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../cleancode/springboot/" class="md-nav__link">
        游릭 Spring Boot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../cleancode/nodejs/" class="md-nav__link">
        游릭 Nodejs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6">
          Code: Listado simple
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Code: Listado simple" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Code: Listado simple
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../develop/basic/angular/" class="md-nav__link">
        游댯 Angular
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../develop/basic/springboot/" class="md-nav__link">
        游릭 Spring Boot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../develop/basic/nodejs/" class="md-nav__link">
        游릭 Nodejs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7">
          Code: Listado paginado
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Code: Listado paginado" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Code: Listado paginado
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../develop/paginated/angular/" class="md-nav__link">
        游댯 Angular
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../develop/paginated/springboot/" class="md-nav__link">
        游릭 Spring Boot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../develop/paginated/nodejs/" class="md-nav__link">
        游릭 Nodejs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_8">
          Code: Listado filtrado
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Code: Listado filtrado" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Code: Listado filtrado
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../develop/filtered/angular/" class="md-nav__link">
        游댯 Angular
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../develop/filtered/springboot/" class="md-nav__link">
        游릭 Spring Boot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../develop/filtered/nodejs/" class="md-nav__link">
        游릭 Nodejs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../exercise/" class="md-nav__link">
        Ahora hazlo tu!
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_10">
          Anexos
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Anexos" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          Anexos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../git/" class="md-nav__link">
        GIT: Tutorial b치sico
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rest/" class="md-nav__link">
        API Rest
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tdd/" class="md-nav__link">
        TDD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../jpa/" class="md-nav__link">
        Spring Data: JPA
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_5" type="checkbox" id="__nav_10_5" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_10_5">
          Spring Cloud
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Spring Cloud" data-md-level="2">
        <label class="md-nav__title" for="__nav_10_5">
          <span class="md-nav__icon md-icon"></span>
          Spring Cloud
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../intro/" class="md-nav__link">
        Introducic칩n
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../basic/" class="md-nav__link">
        Listado simple
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../paginated/" class="md-nav__link">
        Listado paginado
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../filtered/" class="md-nav__link">
        Listado filtrado
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Infraestructura
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Infraestructura
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#discovery-service-eureka" class="md-nav__link">
    Discovery Service - Eureka
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#micro-servicios" class="md-nav__link">
    Micro servicios
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gateway" class="md-nav__link">
    Gateway
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#feign-client" class="md-nav__link">
    Feign Client
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#discovery-service-eureka" class="md-nav__link">
    Discovery Service - Eureka
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#micro-servicios" class="md-nav__link">
    Micro servicios
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gateway" class="md-nav__link">
    Gateway
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#feign-client" class="md-nav__link">
    Feign Client
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="infraestructura-spring-cloud">Infraestructura - Spring Cloud</h1>
<p>Creados los tres micro servicios que compondr치n nuestro aplicativo, ya podemos empezar con la creaci칩n de las piezas de infraestructura que ser치n las encargadas de realizar la orquestaci칩n.</p>
<h2 id="discovery-service-eureka">Discovery Service - Eureka</h2>
<p>Para esta pieza debemos crear un nuevo proyecto de una forma similar a la que estamos acostumbrados.</p>
<p>Volviendo una vez m치s a <a href="https://start.spring.io/">Spring Initializr</a> seleccionaremos los siguientes datos:</p>
<ul>
<li>Tipo de proyecto: Maven</li>
<li>Lenguage: Java</li>
<li>Versi칩n Spring boot: 3.0.4 (o alguna similar)</li>
<li>Group: com.ccsw</li>
<li>ArtifactId: tutorial-eureka</li>
<li>Versi칩n Java: 19</li>
<li>Dependencias: Eureka Server</li>
</ul>
<p><img alt="initializr" src="../../../assets/images/initializr-eureka.png" /></p>
<p>Esto nos generar치 un proyecto que ya vendr치 con la dependencia de Eureka Server, solo deberemos habilitarlo y darle la configuraci칩n deseada.</p>
<p>En primer lugar, a침adimos la anotaci칩n que habilita el servidor de Eureka.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:1"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">TutorialEurekaApplication.java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">package</span> <span class="nn">com.ccsw.tutorialeureka</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.boot.SpringApplication</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.autoconfigure.SpringBootApplication</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.cloud.netflix.eureka.server.EnableEurekaServer</span><span class="p">;</span>

<span class="nd">@SpringBootApplication</span>
<span class="hll"><span class="nd">@EnableEurekaServer</span>
</span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TutorialEurekaApplication</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">SpringApplication</span><span class="p">.</span><span class="na">run</span><span class="p">(</span><span class="n">TutorialEurekaApplication</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">args</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>Ahora debemos a침adir las configuraciones necesarias. En primer lugar para facilitar la visualizaci칩n de las propiedades vamos a renombrar nuestro fichero <code>application.properties</code> a <code>application.yml</code>. 
Hecho esto, a침adimos la configuraci칩n de puerto que ya conocemos y a침adimos directivas sobre que Eureka no se registre a s칤 mismo dentro del cat치logo de servicios.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:1"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">application.yml</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>server:
  port: 8761
eureka:
  client:
    registerWithEureka: false
    fetchRegistry: false
</code></pre></div>
</div>
</div>
</div>
<p>Hechas estas sencillas configuraciones y arrancando el proyecto, nos dirigimos a la <code>http://localhost/8761</code> donde podemos ver la interfaz de Eureka y si miramos con detenimiento, vemos que el cat치logo de servicios aparece vac칤o, ya que a칰n no se ha registrado ninguno de ellos.</p>
<h2 id="micro-servicios">Micro servicios</h2>
<p>Ahora ya tenemos disponible Eureka y podemos proceder a registrar nuestros micro servicios dentro del cat치logo, vamos a realizar las mismas modificaciones sobre los tres micro servicios.</p>
<p>Para este fin debemos a침adir una nueva dependencia dentro del <code>pom.xml</code> y modificar la configuraci칩n del proyecto.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">pom.xml</label><label for="__tabbed_3_2">application.properties</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
<span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
    <span class="nt">&lt;parent&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-parent<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>3.0.4<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;relativePath/&gt;</span> <span class="cm">&lt;!-- lookup parent from repository --&gt;</span>
    <span class="nt">&lt;/parent&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>com.ccsw<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>tutorial-XXX<span class="nt">&lt;/artifactId&gt;</span> <span class="cm">&lt;!-- Cada proyecto tiene su configaci칩n propia, NO modificar --&gt;</span>
    <span class="nt">&lt;version&gt;</span>0.0.1-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;name&gt;</span>tutorial-XXX<span class="nt">&lt;/name&gt;</span> <span class="cm">&lt;!-- Cada proyecto tiene su configaci칩n propia, NO modificar --&gt;</span>
    <span class="nt">&lt;description&gt;</span>Demo project for Spring Boot<span class="nt">&lt;/description&gt;</span>
    <span class="nt">&lt;properties&gt;</span>
        <span class="nt">&lt;java.version&gt;</span>19<span class="nt">&lt;/java.version&gt;</span>
<span class="hll">        <span class="nt">&lt;spring-cloud.version&gt;</span>2022.0.1<span class="nt">&lt;/spring-cloud.version&gt;</span>
</span>    <span class="nt">&lt;/properties&gt;</span>
    <span class="nt">&lt;dependencies&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-data-jpa<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-web<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>

        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.springdoc<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>springdoc-openapi-starter-webmvc-ui<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>2.0.3<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>

        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.hibernate<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>hibernate-validator<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>8.0.0.Final<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>

        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>net.sf.dozer<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>dozer<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>5.5.1<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>

<span class="hll">        <span class="nt">&lt;dependency&gt;</span>
</span><span class="hll">            <span class="nt">&lt;groupId&gt;</span>org.springframework.cloud<span class="nt">&lt;/groupId&gt;</span>
</span><span class="hll">            <span class="nt">&lt;artifactId&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="nt">&lt;/artifactId&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/dependency&gt;</span>
</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>com.h2database<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>h2<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;scope&gt;</span>runtime<span class="nt">&lt;/scope&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-test<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;/dependencies&gt;</span>
<span class="hll">    <span class="nt">&lt;dependencyManagement&gt;</span>
</span><span class="hll">        <span class="nt">&lt;dependencies&gt;</span>
</span><span class="hll">            <span class="nt">&lt;dependency&gt;</span>
</span><span class="hll">                <span class="nt">&lt;groupId&gt;</span>org.springframework.cloud<span class="nt">&lt;/groupId&gt;</span>
</span><span class="hll">                <span class="nt">&lt;artifactId&gt;</span>spring-cloud-dependencies<span class="nt">&lt;/artifactId&gt;</span>
</span><span class="hll">                <span class="nt">&lt;version&gt;</span>${spring-cloud.version}<span class="nt">&lt;/version&gt;</span>
</span><span class="hll">                <span class="nt">&lt;type&gt;</span>pom<span class="nt">&lt;/type&gt;</span>
</span><span class="hll">                <span class="nt">&lt;scope&gt;</span>import<span class="nt">&lt;/scope&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/dependency&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/dependencies&gt;</span>
</span><span class="hll">    <span class="nt">&lt;/dependencyManagement&gt;</span>
</span>
    <span class="nt">&lt;build&gt;</span>
        <span class="nt">&lt;plugins&gt;</span>
            <span class="nt">&lt;plugin&gt;</span>
                <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
                <span class="nt">&lt;artifactId&gt;</span>spring-boot-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;/plugin&gt;</span>
        <span class="nt">&lt;/plugins&gt;</span>
    <span class="nt">&lt;/build&gt;</span>

<span class="nt">&lt;/project&gt;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="hll"><span class="na">spring.application.name</span><span class="o">=</span><span class="s">spring-cloud-eureka-client-XXX</span><span class="w"></span>
</span><span class="na">server.port</span><span class="o">=</span><span class="s">809X</span><span class="w"></span>

<span class="c">#Database</span><span class="w"></span>
<span class="na">spring.datasource.url</span><span class="o">=</span><span class="s">jdbc:h2:mem:testdb</span><span class="w"></span>
<span class="na">spring.datasource.username</span><span class="o">=</span><span class="s">sa</span><span class="w"></span>
<span class="na">spring.datasource.password</span><span class="o">=</span><span class="s">sa</span><span class="w"></span>
<span class="na">spring.datasource.driver-class-name</span><span class="o">=</span><span class="s">org.h2.Driver</span><span class="w"></span>

<span class="na">spring.jpa.database-platform</span><span class="o">=</span><span class="s">org.hibernate.dialect.H2Dialect</span><span class="w"></span>
<span class="na">spring.jpa.defer-datasource-initialization</span><span class="o">=</span><span class="s">true</span><span class="w"></span>
<span class="na">spring.jpa.show-sql</span><span class="o">=</span><span class="s">true</span><span class="w"></span>

<span class="na">spring.h2.console.enabled</span><span class="o">=</span><span class="s">true</span><span class="w"></span>

<span class="hll"><span class="c">#Eureka</span><span class="w"></span>
</span><span class="hll"><span class="na">eureka.client.serviceUrl.defaultZone</span><span class="o">=</span><span class="s">${EUREKA_URI:http://localhost:8761/eureka}</span><span class="w"></span>
</span><span class="hll"><span class="na">eureka.instance.preferIpAddress</span><span class="o">=</span><span class="s">true</span><span class="w"></span>
</span></code></pre></div>
</div>
</div>
</div>
<p>Como podemos observar, lo que hemos hecho, es a침adir la dependencia de Eureka Client y le hemos comunicado a cada micro servicio donde tenemos arrancado Eureka. De este modo al arrancar cada micro servicio, este se registrar치 autom치ticamente dentro de Eureka.</p>
<p>Para poder diferenciar cada micro servicio, estos tienen su configuraci칩n de nombre y puerto (mantenemos el puerto que hab칤amos configurado en pasos previos):</p>
<ul>
<li>Categor칤as: <code>spring.application.name=spring-cloud-eureka-client-category</code></li>
<li>Autores: <code>spring.application.name=spring-cloud-eureka-client-author</code></li>
<li>Juegos: <code>spring.application.name=spring-cloud-eureka-client-game</code></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Nombres en vez de rutas</p>
<p>Estos nombres ser치n por los que vamos a identificar cada micro servicio dentro de Eureka que ser치 quien conozca las rutas de los mismos, asi cuando queramos realizar redirecciones a estos no necesitaremos conocerlas rutas ni los puertos de los mismos, con proporcionar los nombres tendremos la informaci칩n completa de como llegar a ellos.</p>
</div>
<p>Hechas esto y arrancados los micro servicios, volvemos a dirigirnos a Eureka en <code>http://localhost/8761</code> donde podemos ver que estos aparecen en el listado de servicios registrados.</p>
<h2 id="gateway">Gateway</h2>
<p>Para esta pieza debemos crear un nuevo proyecto de una forma similar a la de Eureka.</p>
<p>Volviendo una vez m치s a <a href="https://start.spring.io/">Spring Initializr</a> seleccionaremos los siguientes datos:</p>
<ul>
<li>Tipo de proyecto: Maven</li>
<li>Lenguage: Java</li>
<li>Versi칩n Spring boot: 3.0.4 (o alguna similar)</li>
<li>Group: com.ccsw</li>
<li>ArtifactId: tutorial-gateway</li>
<li>Versi칩n Java: 19</li>
<li>Dependencias: Gateway, Eureka Client</li>
</ul>
<p><img alt="initializr" src="../../../assets/images/initializr-gateway.png" /></p>
<p>Esto nos generar치 un proyecto que ya vendr치 con las dependencias de Gateway y Eureka Client, solo deberemos a침adir las configuraciones pertinentes.</p>
<p>Al igual que en el caso de Eureka vamos a renombrar nuestro fichero <code>application.properties</code> a <code>application.yml</code>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:1"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">application.yml</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>server:
  port: 8080
eureka:
  client:
    serviceUrl:
      defaultZone: http://localhost:8761/eureka
spring:
  application:
    name: spring-cloud-eureka-client-gateway
  cloud:
    gateway:
      default-filters:
        - DedupeResponseHeader=Access-Control-Allow-Credentials Access-Control-Allow-Origin
      globalcors:
        corsConfigurations:
          &#39;[/**]&#39;:
             allowedOrigins: &quot;*&quot;
             allowedMethods: &quot;*&quot;
             allowedHeaders: &quot;*&quot;
      routes:
        - id: category
          uri: lb://SPRING-CLOUD-EUREKA-CLIENT-CATEGORY
          predicates:
            - Path=/category/**
        - id: author
          uri: lb://SPRING-CLOUD-EUREKA-CLIENT-AUTHOR
          predicates:
            - Path=/author/**
        - id: game
          uri: lb://SPRING-CLOUD-EUREKA-CLIENT-GAME
          predicates:
            - Path=/game/**
</code></pre></div>
</div>
</div>
</div>
<p>Lo que hemos hecho aqu칤 es configurar el puerto como <code>8080</code> ya que el Gateway va a ser nuestro punto de acceso y el encargado de redirigir cada petici칩n al micro servicio correcto.</p>
<p>Posteriormente hemos configurado el cliente de Eureka para que el Gateway establezca comunicaci칩n con Eureka que hemos configurado previamente para, en primer lugar, registrarse como un cliente y seguidamente obtener informaci칩n del cat치logo de servicios existentes.</p>
<p>El paso siguiente es darle un nombre a la aplicaci칩n para que se registre en Eureka y a침adir configuraci칩n de CORS para que cuando realicemos las llamadas desde navegador pueda realizar la redirecci칩n correctamente.</p>
<p>Finalmente a침adimos las directrices de redirecci칩n al Gateway indic치ndole los nombres de los micro servicios con los que estos se han registrado en Eureka junto a los predicados que incluyen las rutas parciales que queremos que sean redirigidas a cada micro servicio.</p>
<p>Con esto nos queda la siguiente configuraci칩n:</p>
<ul>
<li>Las rutas que incluyan <code>category</code> redirigir치n al micro servicio de <code>Categorias</code></li>
<li>Las rutas que incluyan <code>author</code> redirigir치n al micro servicio de <code>Autores</code></li>
<li>Las rutas que incluyan <code>game</code> redirigir치n al micro servicio de <code>Juegos</code></li>
</ul>
<p>Hechas esto y arrancado el proyecto, volvemos a dirigirnos a Eureka en <code>http://localhost/8761</code> donde podemos ver que el Gateway se ha registrado correctamente junto al resto de clientes.</p>
<h2 id="feign-client">Feign Client</h2>
<p>El 칰ltimo paso es la implementaci칩n de la comunicaci칩n entre los micro servicios, en este caso necesitamos que nuestro micro servicio de <code>Juegos</code> obtenga datos de <code>Categor칤as</code> y <code>Autores</code> para poder servir informaci칩n completa de los <code>Juegos</code> ya que en su modelo solo posee los identificadores.</p>
<p>Para la comunicaci칩n entre los distintos servicios, Spring Cloud nos prove de <code>Feign Clients</code> que ofrecen una interfaz muy sencilla de comunicaci칩n a trav칠s de la infraestructura construida.</p>
<p>En primer lugar debemos a침adir la dependencia necesaria dentro de nuestro pom.xml del micro servicio de <code>Juegos</code>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:1"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">pom.xml</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>...
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.springframework.cloud<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>

<span class="hll">        <span class="nt">&lt;dependency&gt;</span>
</span><span class="hll">            <span class="nt">&lt;groupId&gt;</span>org.springframework.cloud<span class="nt">&lt;/groupId&gt;</span>
</span><span class="hll">            <span class="nt">&lt;artifactId&gt;</span>spring-cloud-starter-openfeign<span class="nt">&lt;/artifactId&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/dependency&gt;</span>
</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>com.h2database<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>h2<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;scope&gt;</span>runtime<span class="nt">&lt;/scope&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
...
</code></pre></div>
</div>
</div>
</div>
<p>El siguiente paso es habilitar el uso de los <code>Feign Clients</code>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:1"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">TutorialEurekaApplication.java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">package</span> <span class="nn">com.ccsw.tutorialgame</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.boot.SpringApplication</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.autoconfigure.SpringBootApplication</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.cloud.openfeign.EnableFeignClients</span><span class="p">;</span>

<span class="nd">@SpringBootApplication</span>
<span class="hll"><span class="nd">@EnableFeignClients</span>
</span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TutorialGameApplication</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">SpringApplication</span><span class="p">.</span><span class="na">run</span><span class="p">(</span><span class="n">TutorialGameApplication</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">args</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>Realizadas las configuraciones ya podemos realizar los cambios necesarios en nuestro c칩digo para implementar la comunicaci칩n. En primer lugar vamos a crear los clientes de <code>Categor칤as</code> y <code>Autores</code>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">CategoryClient.java</label><label for="__tabbed_7_2">AuthorClient.java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">package</span> <span class="nn">com.ccsw.tutorialgame.category</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.ccsw.tutorialgame.category.model.CategoryDto</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.cloud.openfeign.FeignClient</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.GetMapping</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>

<span class="nd">@FeignClient</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;SPRING-CLOUD-EUREKA-CLIENT-CATEGORY&quot;</span><span class="p">,</span> <span class="n">url</span> <span class="o">=</span> <span class="s">&quot;http://localhost:8080&quot;</span><span class="p">)</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">CategoryClient</span> <span class="p">{</span>

    <span class="nd">@GetMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;/category&quot;</span><span class="p">)</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">CategoryDto</span><span class="o">&gt;</span> <span class="nf">findAll</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">package</span> <span class="nn">com.ccsw.tutorialgame.author</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.ccsw.tutorialgame.author.model.AuthorDto</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.cloud.openfeign.FeignClient</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.GetMapping</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>

<span class="nd">@FeignClient</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;SPRING-CLOUD-EUREKA-CLIENT-AUTHOR&quot;</span><span class="p">,</span> <span class="n">url</span> <span class="o">=</span> <span class="s">&quot;http://localhost:8080&quot;</span><span class="p">)</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">AuthorClient</span> <span class="p">{</span>

    <span class="nd">@GetMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;/author&quot;</span><span class="p">)</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">AuthorDto</span><span class="o">&gt;</span> <span class="nf">findAll</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>Lo que hacemos aqu칤 es crear una simple interfaz donde a침adimos la configuraci칩n del <code>Feign Client</code> con la url del Gateway a trav칠s del cual vamos a realizar todas las comunicaciones y creamos un m칠todo abstracto con la anotaci칩n pertinente para hacer referencia al endpoint de obtenci칩n del listado.</p>
<p>Con esto ya podemos inyectas estas interfaces dentro de nuestro controlador para obtener todos los datos necesarios que completaran la informaci칩n de la <code>Categor칤a</code> y <code>Autor</code> de cada <code>Juego</code>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:1"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">AuthorClient.java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">package</span> <span class="nn">com.ccsw.tutorialgame.game</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.ccsw.tutorialgame.author.AuthorClient</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.ccsw.tutorialgame.author.model.AuthorDto</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.ccsw.tutorialgame.category.CategoryClient</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.ccsw.tutorialgame.category.model.CategoryDto</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.ccsw.tutorialgame.game.model.Game</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.ccsw.tutorialgame.game.model.GameDto</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">io.swagger.v3.oas.annotations.Operation</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">io.swagger.v3.oas.annotations.tags.Tag</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.*</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.stream.Collectors</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * @author ccsw</span>
<span class="cm"> *</span>
<span class="cm"> */</span>
<span class="nd">@Tag</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Game&quot;</span><span class="p">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">&quot;API of Game&quot;</span><span class="p">)</span>
<span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;/game&quot;</span><span class="p">)</span>
<span class="nd">@RestController</span>
<span class="nd">@CrossOrigin</span><span class="p">(</span><span class="n">origins</span> <span class="o">=</span> <span class="s">&quot;*&quot;</span><span class="p">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GameController</span> <span class="p">{</span>

    <span class="nd">@Autowired</span>
    <span class="n">GameService</span> <span class="n">gameService</span><span class="p">;</span>

<span class="hll">    <span class="nd">@Autowired</span>
</span><span class="hll">    <span class="n">CategoryClient</span> <span class="n">categoryClient</span><span class="p">;</span>
</span>
<span class="hll">    <span class="nd">@Autowired</span>
</span><span class="hll">    <span class="n">AuthorClient</span> <span class="n">authorClient</span><span class="p">;</span>
</span>
    <span class="cm">/**</span>
<span class="cm">     * M칠todo para recuperar una lista de {@link Game}</span>
<span class="cm">     *</span>
<span class="cm">     * @param title t칤tulo del juego</span>
<span class="cm">     * @param idCategory PK de la categor칤a</span>
<span class="cm">     * @return {@link List} de {@link GameDto}</span>
<span class="cm">     */</span>
    <span class="nd">@Operation</span><span class="p">(</span><span class="n">summary</span> <span class="o">=</span> <span class="s">&quot;Find&quot;</span><span class="p">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">&quot;Method that return a filtered list of Games&quot;</span><span class="p">)</span>
    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">GET</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">GameDto</span><span class="o">&gt;</span> <span class="nf">find</span><span class="p">(</span><span class="nd">@RequestParam</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;title&quot;</span><span class="p">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="p">)</span> <span class="n">String</span> <span class="n">title</span><span class="p">,</span>
                              <span class="nd">@RequestParam</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;idCategory&quot;</span><span class="p">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="p">)</span> <span class="n">Long</span> <span class="n">idCategory</span><span class="p">)</span> <span class="p">{</span>

<span class="hll">        <span class="n">List</span><span class="o">&lt;</span><span class="n">CategoryDto</span><span class="o">&gt;</span> <span class="n">categories</span> <span class="o">=</span> <span class="n">categoryClient</span><span class="p">.</span><span class="na">findAll</span><span class="p">();</span>
</span><span class="hll">        <span class="n">List</span><span class="o">&lt;</span><span class="n">AuthorDto</span><span class="o">&gt;</span> <span class="n">authors</span> <span class="o">=</span> <span class="n">authorClient</span><span class="p">.</span><span class="na">findAll</span><span class="p">();</span>
</span><span class="hll">
</span><span class="hll">        <span class="k">return</span> <span class="n">gameService</span><span class="p">.</span><span class="na">find</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">idCategory</span><span class="p">).</span><span class="na">stream</span><span class="p">().</span><span class="na">map</span><span class="p">(</span><span class="n">game</span> <span class="o">-&gt;</span> <span class="p">{</span>
</span><span class="hll">            <span class="n">GameDto</span> <span class="n">gameDto</span> <span class="o">=</span> <span class="k">new</span> <span class="n">GameDto</span><span class="p">();</span>
</span><span class="hll">
</span><span class="hll">            <span class="n">gameDto</span><span class="p">.</span><span class="na">setId</span><span class="p">(</span><span class="n">game</span><span class="p">.</span><span class="na">getId</span><span class="p">());</span>
</span><span class="hll">            <span class="n">gameDto</span><span class="p">.</span><span class="na">setTitle</span><span class="p">(</span><span class="n">game</span><span class="p">.</span><span class="na">getTitle</span><span class="p">());</span>
</span><span class="hll">            <span class="n">gameDto</span><span class="p">.</span><span class="na">setAge</span><span class="p">(</span><span class="n">game</span><span class="p">.</span><span class="na">getAge</span><span class="p">());</span>
</span><span class="hll">            <span class="n">gameDto</span><span class="p">.</span><span class="na">setCategory</span><span class="p">(</span><span class="n">categories</span><span class="p">.</span><span class="na">stream</span><span class="p">().</span><span class="na">filter</span><span class="p">(</span><span class="n">category</span> <span class="o">-&gt;</span> <span class="n">category</span><span class="p">.</span><span class="na">getId</span><span class="p">().</span><span class="na">equals</span><span class="p">(</span><span class="n">game</span><span class="p">.</span><span class="na">getIdCategory</span><span class="p">())).</span><span class="na">findFirst</span><span class="p">().</span><span class="na">orElse</span><span class="p">(</span><span class="kc">null</span><span class="p">));</span>
</span><span class="hll">            <span class="n">gameDto</span><span class="p">.</span><span class="na">setAuthor</span><span class="p">(</span><span class="n">authors</span><span class="p">.</span><span class="na">stream</span><span class="p">().</span><span class="na">filter</span><span class="p">(</span><span class="n">author</span> <span class="o">-&gt;</span> <span class="n">author</span><span class="p">.</span><span class="na">getId</span><span class="p">().</span><span class="na">equals</span><span class="p">(</span><span class="n">game</span><span class="p">.</span><span class="na">getIdAuthor</span><span class="p">())).</span><span class="na">findFirst</span><span class="p">().</span><span class="na">orElse</span><span class="p">(</span><span class="kc">null</span><span class="p">));</span>
</span><span class="hll">
</span><span class="hll">            <span class="k">return</span> <span class="n">gameDto</span><span class="p">;</span>
</span><span class="hll">        <span class="p">}).</span><span class="na">collect</span><span class="p">(</span><span class="n">Collectors</span><span class="p">.</span><span class="na">toList</span><span class="p">());</span>
</span>    <span class="p">}</span>

    <span class="cm">/**</span>
<span class="cm">     * M칠todo para crear o actualizar un {@link Game}</span>
<span class="cm">     *</span>
<span class="cm">     * @param id PK de la entidad</span>
<span class="cm">     * @param dto datos de la entidad</span>
<span class="cm">     */</span>
    <span class="nd">@Operation</span><span class="p">(</span><span class="n">summary</span> <span class="o">=</span> <span class="s">&quot;Save or Update&quot;</span><span class="p">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">&quot;Method that saves or updates a Game&quot;</span><span class="p">)</span>
    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">path</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="s">&quot;/{id}&quot;</span> <span class="p">},</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">PUT</span><span class="p">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">save</span><span class="p">(</span><span class="nd">@PathVariable</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;id&quot;</span><span class="p">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="p">)</span> <span class="n">Long</span> <span class="n">id</span><span class="p">,</span> <span class="nd">@RequestBody</span> <span class="n">GameDto</span> <span class="n">dto</span><span class="p">)</span> <span class="p">{</span>

        <span class="n">gameService</span><span class="p">.</span><span class="na">save</span><span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">dto</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>Con todo esto, ya tenemos construido nuestro aplicativo de micro servicios con la arquitectura Spring Cloud. Podemos proceder a realizar las mismas pruebas tanto manuales como a trav칠s de los frontales.</p>
<div class="admonition tip">
<p class="admonition-title">Escalado</p>
<p>Una de las principales ventajas de las arquitecturas de micro servicios, es la posibilidad de escalar partes de los aplicativos sin tener que escalar el sistema completo. Para confirmar que esto es asi, podemos levantar multiples instancias de cada servicio en puertos diferentes y veremos que esto se refleja en Eureka y el Gateway balancear치 autom치ticamente entre las distintas instancias.</p>
</div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Pie">
      
        
        <a href="../filtered/" class="md-footer__link md-footer__link--prev" aria-label="Anterior: Listado filtrado" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Anterior
              </span>
              Listado filtrado
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.path", "navigation.indexes"], "translations": {"clipboard.copy": "Copiar al portapapeles", "clipboard.copied": "Copiado al portapapeles", "search.config.lang": "es", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "B\u00fasqueda", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.term.missing": "Falta", "select.version.title": "Seleccionar versi\u00f3n"}, "search": "../../../assets/javascripts/workers/search.bd0b6b67.min.js"}</script>
    
    
      <script src="../../../assets/javascripts/bundle.467223ff.min.js"></script>
      
    
  </body>
</html>