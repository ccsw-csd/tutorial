
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../tdd/">
      
      
        <link rel="next" href="../springcloud/intro/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.12">
    
    
      
        <title>Spring Data: JPA - Tutorial Frontend - Backend</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0d440cfe.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.2505c338.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/style.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#funcionamiento-spring-data" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../.." title="Tutorial Frontend - Backend" class="md-header__button md-logo" aria-label="Tutorial Frontend - Backend" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Tutorial Frontend - Backend
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Spring Data: JPA
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="B칰squeda" placeholder="B칰squeda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando b칰squeda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navegaci칩n" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Tutorial Frontend - Backend" class="md-nav__button md-logo" aria-label="Tutorial Frontend - Backend" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Tutorial Frontend - Backend
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Bienvenido!
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../thanks/" class="md-nav__link">
        Agradecimientos!
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../usecases/" class="md-nav__link">
        Contexto de la aplicaci칩n
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Entorno de desarrollo
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Entorno de desarrollo
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../install/angular/" class="md-nav__link">
        游댯 Angular
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../install/vuejs/" class="md-nav__link">
        游댯 Vue.js
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../install/springboot/" class="md-nav__link">
        游릭 Spring Boot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../install/nodejs/" class="md-nav__link">
        游릭 Nodejs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Estructura y buenas pr치cticas
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Estructura y buenas pr치cticas
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cleancode/angular/" class="md-nav__link">
        游댯 Angular
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cleancode/vuejs/" class="md-nav__link">
        游댯 Vue.js
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cleancode/springboot/" class="md-nav__link">
        游릭 Spring Boot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cleancode/nodejs/" class="md-nav__link">
        游릭 Nodejs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          Code: Listado simple
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Code: Listado simple
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/basic/angular/" class="md-nav__link">
        游댯 Angular
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/basic/springboot/" class="md-nav__link">
        游릭 Spring Boot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/basic/nodejs/" class="md-nav__link">
        游릭 Nodejs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          Code: Listado paginado
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Code: Listado paginado
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/paginated/angular/" class="md-nav__link">
        游댯 Angular
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/paginated/springboot/" class="md-nav__link">
        游릭 Spring Boot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/paginated/nodejs/" class="md-nav__link">
        游릭 Nodejs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
          Code: Listado filtrado
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Code: Listado filtrado
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/filtered/angular/" class="md-nav__link">
        游댯 Angular
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/filtered/springboot/" class="md-nav__link">
        游릭 Spring Boot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/filtered/nodejs/" class="md-nav__link">
        游릭 Nodejs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../exercise/" class="md-nav__link">
        Ahora hazlo tu!
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" checked>
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
          Anexos
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          Anexos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../git/" class="md-nav__link">
        GIT: Tutorial b치sico
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rest/" class="md-nav__link">
        API Rest
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tdd/" class="md-nav__link">
        TDD
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Spring Data: JPA
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Spring Data: JPA
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#funcionamiento-basico" class="md-nav__link">
    Funcionamiento b치sico
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#derived-query-methods" class="md-nav__link">
    Derived Query Methods
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#anotacion-query" class="md-nav__link">
    Anotaci칩n @Query
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#acelerando-las-consultas" class="md-nav__link">
    Acelerando las consultas
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#alternativa-de-streams" class="md-nav__link">
    Alternativa de Streams
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#specifications" class="md-nav__link">
    Specifications
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_5" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_10_5" id="__nav_10_5_label" tabindex="0">
          Spring Cloud
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_10_5">
          <span class="md-nav__icon md-icon"></span>
          Spring Cloud
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../springcloud/intro/" class="md-nav__link">
        Introducci칩n
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../springcloud/basic/" class="md-nav__link">
        Listado simple
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../springcloud/paginated/" class="md-nav__link">
        Listado paginado
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../springcloud/filtered/" class="md-nav__link">
        Listado filtrado
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../springcloud/infra/" class="md-nav__link">
        Infraestructura
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../springcloud/summary/" class="md-nav__link">
        Resumen
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#funcionamiento-basico" class="md-nav__link">
    Funcionamiento b치sico
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#derived-query-methods" class="md-nav__link">
    Derived Query Methods
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#anotacion-query" class="md-nav__link">
    Anotaci칩n @Query
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#acelerando-las-consultas" class="md-nav__link">
    Acelerando las consultas
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#alternativa-de-streams" class="md-nav__link">
    Alternativa de Streams
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#specifications" class="md-nav__link">
    Specifications
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="funcionamiento-spring-data">Funcionamiento Spring Data</h1>
<p>Este anexo no pretende explicar el funcionamiento interno de Spring Data, simplemente conocer un poco como utilizarlo y algunos peque침os tips que pueden ser interesantes.</p>
<h2 id="funcionamiento-basico">Funcionamiento b치sico</h2>
<p>Lo primero que deber칤as tener claro, es que hagas lo que hagas, al final todo termina lanzando una query nativa sobre la BBDD. Da igual que uses cualquier tipo de <em>acelerador</em> (luego veremos alguno), ya que al final Spring Data termina convirtiendo lo que hayas programado en una query nativa.</p>
<p>Cuanta m치s informaci칩n le proporciones a Spring Data, tendr치s m치s control sobre la query final, pero m치s dificil ser치 de mantener. Lo mejor es utilizar, siempre que se pueda, todos los automatismos y automagias posibles y dejar que Spring haga su faena. Habr치 ocasiones en que esto no nos sirva, en ese momento tendremos que decidir si queremos bajar el nivel de implementaci칩n o queremos utilizar otra alternativa como procesos por streams.</p>
<h2 id="derived-query-methods">Derived Query Methods</h2>
<p>Para la realizaci칩n de consultas a la base de datos, Spring Data nos ofrece un sencillo mecanismo que consiste en crear definiciones de m칠todos con una sintaxis especifica, para luego traducirlas autom치ticamente a consultas nativas, por parte de Spring Data.</p>
<p>Esto es muy 칰til, ya que convierte a la aplicaci칩n en agn칩sticos de la tecnolog칤a de BBDD utilizada y podemos migrar con facilidad entre las muchas soluciones disponibles en el mercado, delegando esta tarea en Spring.</p>
<p>Esta es la opci칩n m치s indicada en la mayor칤a de los casos, siempre que puedas deber칤as utilizar esta forma de realizar las consultas. Como parte negativa, en algunos casos en consultas m치s complejas la definici칩n de los m칠todos puede extenderse demasiado dificultando la lectura del c칩digo.</p>
<p>De esto tenemos alg칰n ejemplo por el tutorial, en el repositorio de <a href="../../develop/filtered/springboot/#repository">GameRepository</a>.</p>
<p>Siguiendo el ejemplo del tutorial, si tuvieramos que recuperar los <code>Game</code> por el nombre del juego, se podr칤a crear un m칠todo en el <code>GameRepository</code> de esta forma:</p>
<div class="highlight"><pre><span></span><code><span class="n">List</span><span class="o">&lt;</span><span class="n">Game</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">findByName</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
</code></pre></div>
<p>Spring Data entender칤a que quieres recuperar un listado de <code>Game</code> que est치n filtrados por su propiedad <code>Name</code> y generar칤a la consulta SQL de forma autom치tica, sin tener que implementar nada.</p>
<p>Se pueden contruir muchos m칠todos diferentes, te recomiendo que leas un peque침o <a href="https://www.baeldung.com/spring-data-derived-queries">tutorial de Baeldung</a> y profundices con la <a href="https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#jpa.query-methods.query-creation">documentaci칩n oficial</a> donde podr치s ver todas las opciones.</p>
<h2 id="anotacion-query">Anotaci칩n @Query</h2>
<p>Otra forma de realizar consultas, esta vez menos autom치tica y m치s cercana a SQL, es la anotaci칩n @Query.</p>
<p>Existen dos opciones a la hora de usar la anotaci칩n <code>@Query</code>. Esta anotaci칩n ya la hemos usado en el tutorial, dentro del <a href="../../develop/filtered/springboot/#repository">GameRepository</a>.</p>
<p>En primer lugar tenemos las consultas JPQL. Estas guardan un parecido con el lenguaje SQL pero al igual que en el caso anterior, son traducidas por Spring Data a la consulta final nativa. Su uso no est치 recomendado ya que estamos a침adiendo un nivel de concreci칩n y por tanto estamos aumentando la complejidad del c칩digo. Aun as칤, es otra forma de generar consultas.</p>
<p>Por otra parte, tambi칠n es posible generar consultas nativas directamente dentro de esta anotaci칩n interactuando de forma directa con la base de datos. Esta pr치ctica es altamente desaconsejable ya que crea acoplamientos con la tecnolog칤a de la BBDD utilizada y es una fuente de errores.</p>
<p>Puedes ver m치s informaci칩n de esta anotaci칩n desde este peque침o <a href="https://www.baeldung.com/spring-data-jpa-query">tutorial de Baeldung</a>.</p>
<h2 id="acelerando-las-consultas">Acelerando las consultas</h2>
<p>En muchas ocasiones necesitamos obtener informaci칩n que no est치 en una 칰nica tabla por motivos de dise침o de la base de datos. Debemos plasmar esta casu칤stica con cuidado a nuestro modelo relacional para obtener resultados 칩ptimos en cuanto al rendimiento.</p>
<p>Para ilustrar el caso vamos a recuperar los objetos utilizados en el tutorial <code>Author</code>, <code>Gategory</code> y <code>Game</code>.
Si recuerdas, tenemos que un <code>Game</code> tiene asociado un <code>Author</code> y tiene asociada una <code>Gategory</code>.</p>
<p>Cuando utilizamos el m칠todo de filtrado <code>find</code> que construimos en el <code>GameRepository</code>, vemos que Spring Data traduce la <code>@Query</code> que hab칤amos dise침ado en una query SQL para recuperar los juegos.</p>
<div class="highlight"><pre><span></span><code><span class="nd">@Query</span><span class="p">(</span><span class="s">&quot;select g from Game g where (:title is null or g.title like &#39;%&#39;||:title||&#39;%&#39;) and (:category is null or g.category.id = :category)&quot;</span><span class="p">)</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">Game</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">find</span><span class="p">(</span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;title&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">title</span><span class="p">,</span><span class="w"> </span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;category&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="n">category</span><span class="p">);</span>
</code></pre></div>
<p>Esta <code>@Query</code> es la que utiliza Spring Data para traducir las propiedades a objetos de BBDD y mapear los resultados a objetos Java.
Si tenemos activada la property <code>spring.jpa.show-sql=true</code> podremos ver las queries que est치 generando Spring Data. El resultado es el siguiente.</p>
<div class="highlight"><pre><span></span><code><span class="n">Hibernate</span><span class="p">:</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="n">game0_</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">id1_2_</span><span class="p">,</span><span class="w"> </span><span class="n">game0_</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">age2_2_</span><span class="p">,</span><span class="w"> </span><span class="n">game0_</span><span class="p">.</span><span class="n">author_id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">author_i4_2_</span><span class="p">,</span><span class="w"> </span><span class="n">game0_</span><span class="p">.</span><span class="n">category_id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">category5_2_</span><span class="p">,</span><span class="w"> </span><span class="n">game0_</span><span class="p">.</span><span class="n">title</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">title3_2_</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">game</span><span class="w"> </span><span class="n">game0_</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="p">(</span><span class="o">?</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">game0_</span><span class="p">.</span><span class="n">title</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="o">||?||</span><span class="s1">&#39;%&#39;</span><span class="p">))</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="o">?</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">game0_</span><span class="p">.</span><span class="n">category_id</span><span class="o">=?</span><span class="p">)</span>
<span class="n">Hibernate</span><span class="p">:</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="n">author0_</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">id1_0_0_</span><span class="p">,</span><span class="w"> </span><span class="n">author0_</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">name2_0_0_</span><span class="p">,</span><span class="w"> </span><span class="n">author0_</span><span class="p">.</span><span class="n">nationality</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">national3_0_0_</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">author</span><span class="w"> </span><span class="n">author0_</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">author0_</span><span class="p">.</span><span class="n">id</span><span class="o">=?</span>
<span class="n">Hibernate</span><span class="p">:</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="n">category0_</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">id1_1_0_</span><span class="p">,</span><span class="w"> </span><span class="n">category0_</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">name2_1_0_</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">category</span><span class="w"> </span><span class="n">category0_</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">category0_</span><span class="p">.</span><span class="n">id</span><span class="o">=?</span>
<span class="n">Hibernate</span><span class="p">:</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="n">author0_</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">id1_0_0_</span><span class="p">,</span><span class="w"> </span><span class="n">author0_</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">name2_0_0_</span><span class="p">,</span><span class="w"> </span><span class="n">author0_</span><span class="p">.</span><span class="n">nationality</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">national3_0_0_</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">author</span><span class="w"> </span><span class="n">author0_</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">author0_</span><span class="p">.</span><span class="n">id</span><span class="o">=?</span>
<span class="n">Hibernate</span><span class="p">:</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="n">category0_</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">id1_1_0_</span><span class="p">,</span><span class="w"> </span><span class="n">category0_</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">name2_1_0_</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">category</span><span class="w"> </span><span class="n">category0_</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">category0_</span><span class="p">.</span><span class="n">id</span><span class="o">=?</span>
<span class="n">Hibernate</span><span class="p">:</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="n">author0_</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">id1_0_0_</span><span class="p">,</span><span class="w"> </span><span class="n">author0_</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">name2_0_0_</span><span class="p">,</span><span class="w"> </span><span class="n">author0_</span><span class="p">.</span><span class="n">nationality</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">national3_0_0_</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">author</span><span class="w"> </span><span class="n">author0_</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">author0_</span><span class="p">.</span><span class="n">id</span><span class="o">=?</span>
<span class="n">Hibernate</span><span class="p">:</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="n">author0_</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">id1_0_0_</span><span class="p">,</span><span class="w"> </span><span class="n">author0_</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">name2_0_0_</span><span class="p">,</span><span class="w"> </span><span class="n">author0_</span><span class="p">.</span><span class="n">nationality</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">national3_0_0_</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">author</span><span class="w"> </span><span class="n">author0_</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">author0_</span><span class="p">.</span><span class="n">id</span><span class="o">=?</span>
<span class="n">Hibernate</span><span class="p">:</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="n">author0_</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">id1_0_0_</span><span class="p">,</span><span class="w"> </span><span class="n">author0_</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">name2_0_0_</span><span class="p">,</span><span class="w"> </span><span class="n">author0_</span><span class="p">.</span><span class="n">nationality</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">national3_0_0_</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">author</span><span class="w"> </span><span class="n">author0_</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">author0_</span><span class="p">.</span><span class="n">id</span><span class="o">=?</span>
</code></pre></div>
<p>Si te fijas ha generado una query SQL para filtrar los <code>Game</code>, pero luego cuando ha intentado construir los objetos Java, ha tenido que lanzar una serie de queries para recuperar los diferentes <code>Author</code> y <code>Category</code> a trav칠s de sus <code>id</code>. Obviamente Spring Data es muy lista y cachea los resultados obtenidos para no tener que recuperarlos n veces, pero aun as칤, lanza unas cuantas consultas. Esto penaliza el rendimiento de nuestra operaci칩n, ya que tiene que lanzar n queries a BBDD que, aunque son muy 칩ptimas, incrementan unos milisegundos el tiempo total.</p>
<p>Para evitar esta circunstancia, disponemos de la anotaci칩n denominada <code>@EnitityGraph</code> la cual proporciona directrices a Spring Data sobre la forma en la que deseamos realizar la consulta, permitiendo que realice agrupaciones y uniones de tablas en una 칰nica query que, aun siendo mas compleja, en muchos casos el rendimiento es mucho mejor que realizar m칰ltiples interacciones con la BBDD.</p>
<p>Siguiendo el ejemplo anterior podr칤amos utilizar la anotaci칩n de esta forma:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@Query</span><span class="p">(</span><span class="s">&quot;select g from Game g where (:title is null or g.title like &#39;%&#39;||:title||&#39;%&#39;) and (:category is null or g.category.id = :category)&quot;</span><span class="p">)</span>
<span class="hll"><span class="nd">@EntityGraph</span><span class="p">(</span><span class="n">attributePaths</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;category&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;author&quot;</span><span class="p">})</span>
</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Game</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">find</span><span class="p">(</span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;title&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">title</span><span class="p">,</span><span class="w"> </span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;category&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="n">category</span><span class="p">);</span>
</code></pre></div>
<p>Donde le estamos diciendo a Spring Data que cuando realice la query, haga el cruce con las propiedades <code>category</code> y <code>author</code>, que a su vez son entidades y por tanto mapean dos tablas de BBDD.
El resultado es el siguiente:</p>
<div class="highlight"><pre><span></span><code><span class="n">Hibernate</span><span class="p">:</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="n">game0_</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">id1_2_0_</span><span class="p">,</span><span class="w"> </span><span class="n">category1_</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">id1_1_1_</span><span class="p">,</span><span class="w"> </span><span class="n">author2_</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">id1_0_2_</span><span class="p">,</span><span class="w"> </span><span class="n">game0_</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">age2_2_0_</span><span class="p">,</span><span class="w"> </span><span class="n">game0_</span><span class="p">.</span><span class="n">author_id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">author_i4_2_0_</span><span class="p">,</span><span class="w"> </span><span class="n">game0_</span><span class="p">.</span><span class="n">category_id</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">category5_2_0_</span><span class="p">,</span><span class="w"> </span><span class="n">game0_</span><span class="p">.</span><span class="n">title</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">title3_2_0_</span><span class="p">,</span><span class="w"> </span><span class="n">category1_</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">name2_1_1_</span><span class="p">,</span><span class="w"> </span><span class="n">author2_</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">name2_0_2_</span><span class="p">,</span><span class="w"> </span><span class="n">author2_</span><span class="p">.</span><span class="n">nationality</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">national3_0_2_</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">game</span><span class="w"> </span><span class="n">game0_</span><span class="w"> </span><span class="k">left</span><span class="w"> </span><span class="k">outer</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">category</span><span class="w"> </span><span class="n">category1_</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">game0_</span><span class="p">.</span><span class="n">category_id</span><span class="o">=</span><span class="n">category1_</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">left</span><span class="w"> </span><span class="k">outer</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">author</span><span class="w"> </span><span class="n">author2_</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">game0_</span><span class="p">.</span><span class="n">author_id</span><span class="o">=</span><span class="n">author2_</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="p">(</span><span class="o">?</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">game0_</span><span class="p">.</span><span class="n">title</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="o">||?||</span><span class="s1">&#39;%&#39;</span><span class="p">))</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="o">?</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">game0_</span><span class="p">.</span><span class="n">category_id</span><span class="o">=?</span><span class="p">)</span>
</code></pre></div>
<p>Una 칰nica query, que es m치s compleja que la anterior, ya que hace dos cruces con tablas de BBDD, pero que nos evita tener que lanzar n queries diferentes para recuperar <code>Author</code> y <code>Category</code>.</p>
<p>Generalmente, el uso de <code>@EntityGraph</code> acelera mucho los resultados y es muy recomendable utilizarlo para realizar los cruces inline. Se puede utilizar tanto con <code>@Query</code> como con <code>Derived Query Methods</code>. Puedes leer m치s informaci칩n en este peque침o <a href="https://www.baeldung.com/jpa-entity-graph">tutorial de Baeldung</a>.</p>
<h2 id="alternativa-de-streams">Alternativa de Streams</h2>
<p>A partir de Java 8 disponemos de los Java Streams. Se trata de una herramienta que nos permite multitud de opciones relativas tratamiento y trasformaci칩n de los datos manejados.</p>
<p>En este apartado 칰nicamente se menciona debido a que en muchas ocasiones cuando nos enfrentamos a consultas complejas, puede ser beneficioso evitar ofuscar las consultas y realizar las trasformaciones necesarias mediante los Streams.</p>
<p>Un ejemplo de uso pr치ctico podr칤a ser, evitar usar la cl치usula <code>IN</code> de SQL en una determinada consulta que podr칤a penalizar notablemente el rendimiento de las consultas. En vez de eso se podr칤a utilizar el m칠todo de JAVA <code>filter</code> sobre el conjunto de elementos para obtener el mismo resultado.</p>
<p>Puedes leer m치s informaci칩n en el <a href="https://www.baeldung.com/java-8-streams">tutorial de Baeldung</a>.</p>
<h2 id="specifications">Specifications</h2>
<p>En algunos casos puede ocurrir que con las herramientas descritas anteriormente no tengamos suficiente alcance, bien porque las definiciones de los m칠todos se complican y alargan demasiado o debido a que la consulta es demasiado gen칠rica como para realizarlo de este modo.</p>
<p>Para este caso se dispone de las Specifications que nos proveen de una forma de escribir consultas reutilizables mediante una API que ofrece una forma fluida de crear y combinar consultas complejas.</p>
<p>Un ejemplo de caso de uso podr칤a ser un CRUD de una determinada entidad que debe poder filtrar por todos los atributos de esta, donde el tipo de filtrado viene especificado en la propia consulta y no siempre es requerido. En este caso no podr칤amos construir una consulta basada en definir un determinado m칠todo ya no conocemos de ante mano que filtros ni que atributos vamos a recibir y deberemos recurrir al uso de las Specifications.</p>
<p>Puedes leer m치s informaci칩n en el <a href="https://www.baeldung.com/rest-api-search-language-spring-data-specifications">tutorial de Baeldung</a>.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.path", "navigation.indexes"], "search": "../../assets/javascripts/workers/search.db81ec45.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.4b2c34cd.min.js"></script>
      
    
  </body>
</html>